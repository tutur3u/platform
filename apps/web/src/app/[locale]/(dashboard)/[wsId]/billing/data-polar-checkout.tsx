'use client';
// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';

// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }

// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);

//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;

//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }

//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };

// export default PurchaseLink;

'use client';

// 'use client';
// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';
// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }
// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);
//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;
//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }
//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };
// export default PurchaseLink;
// 'use client';
// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';
// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }
// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);
//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;
//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }
//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };
// export default PurchaseLink;
// 'use client';
// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';
// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }
// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);
//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;
//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }
//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };
// export default PurchaseLink;
// 'use client';
// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';
// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }
// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);
//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;
//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }
//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };
// export default PurchaseLink;
import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
import { Button } from '@tuturuuu/ui/button';
import { CheckoutEvent, DodoPayments } from 'dodopayments-checkout';
import { useCallback, useEffect, useState } from 'react';
import { type PropsWithChildren } from 'react';

// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';
// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }
// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);
//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;
//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }
//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };
// export default PurchaseLink;

// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';
// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }
// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);
//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;
//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }
//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };
// export default PurchaseLink;

// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';
// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }
// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);
//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;
//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }
//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };
// export default PurchaseLink;

// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';
// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }
// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);
//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;
//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }
//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };
// export default PurchaseLink;

// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';
// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }
// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);
//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;
//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }
//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };
// export default PurchaseLink;

// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';
// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }
// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);
//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;
//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }
//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };
// export default PurchaseLink;

// 'use client';
// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';
// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }
// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);
//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;
//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }
//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };
// export default PurchaseLink;

// 'use client';
// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';
// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }
// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);
//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;
//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }
//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };
// export default PurchaseLink;

// 'use client';
// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';
// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }
// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);
//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;
//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }
//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };
// export default PurchaseLink;

// 'use client';
// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';
// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }
// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);
//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;
//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }
//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };
// export default PurchaseLink;

// 'use client';
// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';
// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }
// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);
//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;
//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }
//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };
// export default PurchaseLink;

// 'use client';
// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';
// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }
// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);
//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;
//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }
//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };
// export default PurchaseLink;

// 'use client';
// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';
// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }
// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);
//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;
//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }
//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };
// export default PurchaseLink;

// 'use client';
// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';
// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }
// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);
//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;
//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }
//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };
// export default PurchaseLink;

// 'use client';

// import { PolarEmbedCheckout } from '@polar-sh/checkout/embed';
// import { type PropsWithChildren, useEffect } from 'react';

// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }

// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);

//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;

//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }

//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };

// export default PurchaseLink;

// interface PurchaseLinkProps {
//   productId: string;
//   wsId: string;
//   customerEmail?: string;
//   theme?: 'light' | 'dark' | 'auto';
//   className?: string;
// }

// const PurchaseLink = ({
//   productId,
//   wsId,
//   theme = 'auto',
//   className,
//   children,
// }: PropsWithChildren<PurchaseLinkProps>) => {
//   // useEffect(() => {
//   //   PolarEmbedCheckout.init();
//   // }, []);

//   // ✅ UPDATED: Create the URL with the new dynamic path
//   const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;

//   // You can still add other details as search parameters if you need them
//   // if (customerEmail) {
//   //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
//   // }

//   return (
//     <a
//       href={checkoutUrl.toString()}
//       data-polar-checkout
//       data-polar-checkout-theme={theme}
//       className={className}
//     >
//       {children}
//     </a>
//   );
// };

// export default PurchaseLink;

// interface DodoCheckoutButtonProps {
//   productId: string;
//   wsId: string;
//   // customerEmail="t@test.com";
//   // theme="auto";
// }

// export default function PurchaseLink({
//   productId,
//   wsId,
//   // customerEmail,
//   // theme
// }: DodoCheckoutButtonProps) {
//   const [status, setStatus] = useState<'idle' | 'loading' | 'open' | 'error'>(
//     'idle'
//   );
//   const [message, setMessage] = useState('');
//   // const resposse = payment.payments.create({
//   //   billing: {
//   //     email: '',
//   //     country: 'US',
//   //   },
//   // });
//   // 1. Setup DodoPayments once
//   useEffect(() => {
//     DodoPayments.Initialize({
//       displayType: 'overlay',
//       linkType: 'static',
//       mode: 'test', // or "live"
//       theme: 'light', // or "dark"
//       onEvent: (event: CheckoutEvent) => {
//         console.log('[Dodo event]', event);
//         switch (event.event_type) {
//           case 'checkout.opened':
//             setStatus('open');
//             setMessage('Checkout opened');
//             break;
//           case 'checkout.closed':
//             setStatus('idle');
//             setMessage('Checkout closed');
//             break;
//           case 'checkout.redirect':
//             setStatus('loading');
//             setMessage('Redirecting to payment page...');
//             window.location.href = event.data?.url as string;
//             break;
//           case 'checkout.error':
//             setStatus('error');
//             setMessage(
//               typeof event.data?.message === 'string'
//                 ? event.data.message
//                 : 'An error occurred'
//             );
//             break;
//         }
//       },
//     });
//   }, []);

//   // 2. Trigger checkout
//   const handleCheckout = useCallback(() => {
//     try {
//       setStatus('loading');

//       DodoPayments.Checkout.open({
//         redirectUrl: `${window.location.origin}/${wsId}/billing/success`,
//         products: [
//           {
//             productId,
//             quantity: 5,
//           },
//         ],
//         // metadata: { wsId },
//       });
//     } catch (err) {
//       console.error('Dodo checkout error:', err);
//       setStatus('error');
//       setMessage(
//         err instanceof Error ? err.message : 'Failed to start checkout session'
//       );
//     }
//   }, [productId, wsId]);

//   return (
//     <>
//       <Button
//         onClick={handleCheckout}
//         disabled={status === 'loading' || status === 'open'}
//       >
//         {status === 'loading'
//           ? 'Processing...'
//           : status === 'open'
//             ? 'Checkout Open'
//             : 'Subscribe'}
//       </Button>
//       {message && (
//         <div className="mt-2 text-sm text-muted-foreground">
//           {status === 'error' ? (
//             <span className="text-red-500">{message}</span>
//           ) : (
//             <span>{message}</span>
//           )}
//         </div>
//       )}
//     </>
//   );
// }

// // export default PurchaseLink;

interface PurchaseLinkProps {
  productId: string;
  wsId: string;
  customerEmail?: string;
  theme?: 'light' | 'dark' | 'auto';
  className?: string;
}

const PurchaseLink = ({
  productId,
  wsId,
  customerEmail,
  theme = 'auto',
  className,
  children,
}: PropsWithChildren<PurchaseLinkProps>) => {
  // useEffect(() => {
  //   PolarEmbedCheckout.init();
  // }, []);

  // ✅ UPDATED: Create the URL with the new dynamic path
  const checkoutUrl = `/api/${wsId}/${productId}/payment?productId=${productId}&customerEmail=t@test.com`;

  // You can still add other details as search parameters if you need them
  // if (customerEmail) {
  //   checkoutUrl.searchParams.set('customerEmail', customerEmail);
  // }

  return (
    <a
      href={checkoutUrl.toString()}
      data-polar-checkout
      data-polar-checkout-theme={theme}
      className={className}
    >
      {children}
    </a>
  );
};

export default PurchaseLink;
